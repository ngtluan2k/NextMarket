create database  everymart;

use everymart;


CREATE TABLE `users` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `username` varchar(255),
  `email` varchar(255) UNIQUE,
  `password` varchar(255),
  `status` varchar(255),
  `code` varchar(255) UNIQUE,
  `created_at` datetime,
  `updated_at` datetime
);

CREATE TABLE `user_profiles` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `user_id` int,
  `full_name` varchar(255),
  `dob` date,
  `phone` varchar(255),
  `gender` varchar(255),
  `avatar_url` varchar(255),
  `bio` text,
  `created_at` datetime,
   `country` text
);

CREATE TABLE `user_addresses` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `user_id` int,
  `recipient_name` varchar(255),
  `phone` varchar(255),
  `street` text,
  `city` varchar(255),
  `province` varchar(255),
  `country` varchar(255),
  `postal_code` varchar(255),
  `is_default` boolean,
  `created_at` datetime
);

CREATE TABLE `roles` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `name` varchar(255),
  `description` text,
  `created_at` datetime
);

CREATE TABLE `permissions` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `code` varchar(255) UNIQUE,
  `description` text
);

CREATE TABLE `role_permissions` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `role_id` int,
  `permission_id` int
);

CREATE TABLE `user_roles` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `user_id` int,
  `role_id` int,
  `assigned_at` datetime
);

CREATE TABLE `stores` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `user_id` int,
  `name` varchar(255),
  `slug` varchar(255) UNIQUE,
  `description` text,
  `logo_url` varchar(255),
  `status` varchar(255),
  `created_at` datetime,
  `updated_at` datetime,
	`is_draft` varchar(255) NULL,
	`email` varchar(255) UNIQUE,
	`phone` varchar(255) UNIQUE
);

CREATE TABLE `store_followers` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `store_id` int,
  `user_id` int,
  `followed_at` datetime
);

CREATE TABLE `store_ratings` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `store_id` int,
  `user_id` int,
  `stars` int,
  `comment` text,
  `created_at` datetime
);

CREATE TABLE `store_documents` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `store_id` int,
  `doc_type` varchar(255),
  `file_url` varchar(255),
  `verified` boolean,
  `verified_at` datetime
);

CREATE TABLE `store_bank_accounts` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `store_id` int,
  `bank_name` varchar(255),
  `account_number` varchar(255),
  `account_holder` varchar(255),
  `is_default` boolean,
  `created_at` datetime
);

CREATE TABLE `payouts` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `store_id` int,
  `amount` decimal,
  `status` varchar(255),
  `requested_at` datetime,
  `processed_at` datetime
);

CREATE TABLE `brands` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `name` varchar(255),
  `description` text,
  `logo_url` varchar(255),
  `created_at` datetime
);

CREATE TABLE `categories` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `parent_id` int,
  `name` varchar(255),
  `slug` varchar(255) UNIQUE,
  `description` text,
  `created_at` datetime,
  `image` nvarchar(255),
  `is_deleted` boolean
);

CREATE TABLE `collections` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `name` varchar(255),
  `description` text,
  `banner_url` varchar(255),
  `status` varchar(255),
  `created_at` datetime
);

CREATE TABLE `products` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `store_id` int,
  `brand_id` int,
  `name` varchar(255),
  `slug` varchar(255) UNIQUE,
  `short_description` text,
  `description` text,
  `base_price` decimal,
  `status` varchar(255),
  `created_at` datetime,
  `updated_at` datetime
);

CREATE TABLE `product_category` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `product_id` int,
  `category_id` int
);


CREATE TABLE `product_collection` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `product_id` int,
  `collection_id` int
);

CREATE TABLE `product_media` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `product_id` int,
  `media_type` varchar(255),
  `url` varchar(255),
  `is_primary` boolean,
  `sort_order` int,
  `variant_id` int
);

CREATE TABLE `variants` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `product_id` int,
  `sku` varchar(255) UNIQUE,
  `variant_name` varchar(255),
  `price` decimal,
  `stock` int,
  `barcode` varchar(255),
  `created_at` datetime,
  `updated_at` datetime
);

CREATE TABLE `inventory` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `product_id` int,
  `variant_id` int,
  `location` varchar(255),
  `quantity` int,
  `reserved_stock` INT ,
  `used_quantity` int,
  `updated_at` datetime
);

CREATE TABLE `pricing_rules` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `product_id` int,
  `type` varchar(255),
  `min_quantity` int,
  `price` decimal,
  `cycle` varchar(255),
  `starts_at` datetime,
  `ends_at` datetime
);

CREATE TABLE `vouchers` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `code` varchar(255) UNIQUE,
  `description` text,
  `discount_type` varchar(255),
  `discount_value` decimal,
  `min_order_amount` decimal,
  `start_date` datetime,
  `end_date` datetime,
  `usage_limit` int,
  `used_count` int,
  `created_at` datetime
);

CREATE TABLE `voucher_usage` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `voucher_id` int,
  `user_id` int,
  `order_id` int,
  `used_at` datetime
);

CREATE TABLE `shopping_carts` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `user_id` int,
  `created_at` datetime,
  `updated_at` datetime
);



CREATE TABLE `cart_items` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `cart_id` int,
  `product_id` int,
  `variant_id` int,
  `quantity` int,
  `price` decimal,
  `added_at` datetime
);

CREATE TABLE `wishlists` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `user_id` int,
  `name` varchar(255),
  `created_at` datetime
);

CREATE TABLE `wishlist_items` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `wishlist_id` int,
  `product_id` int,
  `added_at` datetime
);

CREATE TABLE `orders` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `user_id` int,
  `store_id` int,
  `address_id` int,
  `status` varchar(255),
  `payment_status` varchar(255),
  `shipping_fee` decimal,
  `discount_total` decimal,
  `total_amount` decimal,
  `currency` varchar(255),
  `sub_total` DECIMAL(10,2),
  `created_at` datetime,
  `updated_at` datetime
);

CREATE TABLE `order_items` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `order_id` int,
  `product_id` int,
  `variant_id` int,
  `quantity` int,
  `price` decimal,
  `discount` decimal,
  `subtotal` decimal
);

CREATE TABLE `order_status_history` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `order_id` int,
  `old_status` varchar(255),
  `new_status` varchar(255),
  `changed_by` int,
  `changed_at` datetime,
  `note` text
);

CREATE TABLE `order_invoices` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `order_id` int,
  `invoice_number` varchar(255) UNIQUE,
  `tax_number` varchar(255),
  `company_name` varchar(255),
  `company_address` varchar(255),
  `total_tax` decimal,
  `created_at` datetime
);

CREATE TABLE `payments` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `order_id` int,
  `method` varchar(255),
  `provider` varchar(255),
  `transaction_id` varchar(255),
  `amount` decimal,
  `status` varchar(255),
  `paid_at` datetime,
  `raw_payload` text,
  `created_at` datetime
);



CREATE TABLE `payment_methods` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `name` varchar(255),
  `type` varchar(255),
  `config` json,
  `enabled` boolean,
  `created_at` datetime
);

CREATE TABLE `payment_transactions` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `payment_id` int,
  `provider_transaction_id` varchar(255),
  `amount` decimal,
  `status` varchar(255),
  `created_at` datetime
);

CREATE TABLE `refunds` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `order_id` int,
  `payment_id` int,
  `amount` decimal,
  `reason` text,
  `status` varchar(255),
  `requested_at` datetime,
  `processed_at` datetime
);

CREATE TABLE `returns` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `order_id` int,
  `order_item_id` int,
  `reason` text,
  `status` varchar(255),
  `requested_at` datetime,
  `received_at` datetime,
  `resolved_at` datetime
);

CREATE TABLE `cancellations` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `order_id` int,
  `requested_by` int,
  `reason` text,
  `status` varchar(255),
  `requested_at` datetime,
  `processed_at` datetime
);

CREATE TABLE `order_shipments` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `order_id` int,
  `shipment_id` int,
  `tracking_number` varchar(255),
  `status` varchar(255),
  `shipped_at` datetime,
  `delivered_at` datetime
);

CREATE TABLE `shipping_providers` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `name` varchar(255),
  `website` varchar(255),
  `contact_phone` varchar(255),
  `contact_email` varchar(255),
  `created_at` datetime
);

CREATE TABLE `shipping_zones` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `name` varchar(255),
  `description` text
);

CREATE TABLE `shipping_rates` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `provider_id` int,
  `zone_id` int,
  `min_weight` decimal,
  `max_weight` decimal,
  `base_fee` decimal,
  `per_kg_fee` decimal,
  `eta_days` int
);

CREATE TABLE `shipping_labels` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `order_id` int,
  `provider_id` int,
  `label_url` varchar(255),
  `created_at` datetime
);

CREATE TABLE `shipments` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `order_id` int,
  `provider_id` int,
  `tracking_number` varchar(255),
  `status` varchar(255),
  `shipped_at` datetime,
  `delivered_at` datetime,
  `last_event_at` datetime
);

CREATE TABLE `shipment_events` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `shipment_id` int,
  `status` varchar(255),
  `location` varchar(255),
  `note` text,
  `occurred_at` datetime
);

CREATE TABLE `campaigns` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `name` varchar(255),
  `description` text,
  `starts_at` datetime,
  `ends_at` datetime,
  `status` varchar(255),
  `banner_url` varchar(255)
);

CREATE TABLE `campaign_products` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `campaign_id` int,
  `product_id` int,
  `promo_price` decimal
);

CREATE TABLE `flash_sales` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `name` varchar(255),
  `starts_at` datetime,
  `ends_at` datetime,
  `status` varchar(255)
);

CREATE TABLE `flash_sale_items` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `flash_id` int,
  `product_id` int,
  `stock` int,
  `sale_price` decimal,
  `per_user_limit` int
);

CREATE TABLE `affiliate_programs` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `name` varchar(255),
  `cookie_days` int,
  `commission_type` varchar(255),
  `commission_value` decimal,
  `status` varchar(255),
  `created_at` datetime
);

CREATE TABLE `affiliate_links` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `program_id` int,
  `user_id` int,
  `code` varchar(255) UNIQUE,
  `created_at` datetime
);

CREATE TABLE `affiliate_commissions` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `link_id` int,
  `order_id` int,
  `amount` decimal,
  `status` varchar(255),
  `created_at` datetime,
  `paid_at` datetime
);

CREATE TABLE `referrals` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `referrer_id` int,
  `referee_id` int,
  `code` varchar(255),
  `status` varchar(255),
  `created_at` datetime
);

CREATE TABLE `wallets` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `user_id` int,
  `balance` decimal,
  `currency` varchar(255),
  `updated_at` datetime
);

CREATE TABLE `wallet_transactions` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `wallet_id` int,
  `type` varchar(255),
  `amount` decimal,
  `reference` varchar(255),
  `created_at` datetime
);

CREATE TABLE `chat_sessions` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `user_id` int,
  `store_id` int,
  `created_at` datetime,
  `closed_at` datetime
);

CREATE TABLE `chat_messages` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `chat_session_id` int,
  `sender_user_id` int,
  `message` text,
  `attachments` json,
  `sent_at` datetime,
  `is_read` boolean
);

CREATE TABLE `notifications` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `user_id` int,
  `type` varchar(255),
  `message` text,
  `is_read` boolean,
  `created_at` datetime
);

CREATE TABLE `audit_logs` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `actor_user_id` int,
  `entity` varchar(255),
  `entity_id` int,
  `action` varchar(255),
  `changes` text,
  `ip_address` varchar(255),
  `created_at` datetime
);

CREATE TABLE `activity_logs` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `user_id` int,
  `action` varchar(255),
  `context` text,
  `created_at` datetime
);

CREATE TABLE `error_logs` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `level` varchar(255),
  `source` varchar(255),
  `message` text,
  `stacktrace` text,
  `occurred_at` datetime
);

CREATE TABLE `feature_flags` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `key` varchar(255) UNIQUE,
  `description` text,
  `enabled` boolean,
  `created_at` datetime,
  `updated_at` datetime
);

CREATE TABLE `system_settings` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `key` varchar(255) UNIQUE,
  `value` text,
  `scope` varchar(255),
  `updated_at` datetime
);

CREATE TABLE `security_events` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `user_id` int,
  `event_type` varchar(255),
  `details` text,
  `occurred_at` datetime
);

CREATE TABLE `search_history` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `user_id` int,
  `query` text,
  `results_count` int,
  `searched_at` datetime
);

CREATE TABLE `recommendations` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `user_id` int,
  `product_id` int,
  `score` decimal,
  `created_at` datetime
);

CREATE TABLE `search_suggestions` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `term` varchar(255),
  `popularity` int,
  `updated_at` datetime
);

CREATE TABLE `files` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `owner_user_id` int,
  `url` varchar(255),
  `mime_type` varchar(255),
  `size` int,
  `created_at` datetime
);

CREATE TABLE `tags` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `name` varchar(255)
);

CREATE TABLE `product_tag` (
  `id` int PRIMARY KEY AUTO_INCREMENT,
  `uuid` char(36) UNIQUE NOT NULL,
  `product_id` int,
  `tag_id` int
);

-- ALter table `products` ADD COLUMN `category_id` int null; -- 

ALTER TABLE `product_media` ADD FOREIGN KEY (`variant_id`) REFERENCES `variants` (`id`);

ALTER TABLE `user_profiles` ADD FOREIGN KEY (`user_id`) REFERENCES `users` (`id`);

ALTER TABLE `user_addresses` ADD FOREIGN KEY (`user_id`) REFERENCES `users` (`id`);

ALTER TABLE `role_permissions` ADD FOREIGN KEY (`role_id`) REFERENCES `roles` (`id`);

ALTER TABLE `role_permissions` ADD FOREIGN KEY (`permission_id`) REFERENCES `permissions` (`id`);

ALTER TABLE `user_roles` ADD FOREIGN KEY (`user_id`) REFERENCES `users` (`id`);

ALTER TABLE `user_roles` ADD FOREIGN KEY (`role_id`) REFERENCES `roles` (`id`);

ALTER TABLE `stores` ADD FOREIGN KEY (`user_id`) REFERENCES `users` (`id`);

ALTER TABLE `store_followers` ADD FOREIGN KEY (`store_id`) REFERENCES `stores` (`id`);

ALTER TABLE `store_followers` ADD FOREIGN KEY (`user_id`) REFERENCES `users` (`id`);

ALTER TABLE `store_ratings` ADD FOREIGN KEY (`store_id`) REFERENCES `stores` (`id`);

ALTER TABLE `store_ratings` ADD FOREIGN KEY (`user_id`) REFERENCES `users` (`id`);

ALTER TABLE `store_documents` ADD FOREIGN KEY (`store_id`) REFERENCES `stores` (`id`);

ALTER TABLE `store_bank_accounts` ADD FOREIGN KEY (`store_id`) REFERENCES `stores` (`id`);

ALTER TABLE `payouts` ADD FOREIGN KEY (`store_id`) REFERENCES `stores` (`id`);

ALTER TABLE `categories` ADD FOREIGN KEY (`parent_id`) REFERENCES `categories` (`id`);

ALTER TABLE `products` ADD FOREIGN KEY (`store_id`) REFERENCES `stores` (`id`);

ALTER TABLE `products` ADD FOREIGN KEY (`brand_id`) REFERENCES `brands` (`id`);

-- ALTER TABLE `products` ADD FOREIGN KEY (`category_id`) REFERENCES `categories` (`id`);

ALTER TABLE `product_category` ADD FOREIGN KEY (`product_id`) REFERENCES `products` (`id`);

ALTER TABLE `product_category` ADD FOREIGN KEY (`category_id`) REFERENCES `categories` (`id`);

ALTER TABLE `product_collection` ADD FOREIGN KEY (`product_id`) REFERENCES `products` (`id`);

ALTER TABLE `product_collection` ADD FOREIGN KEY (`collection_id`) REFERENCES `collections` (`id`);

ALTER TABLE `product_media` ADD FOREIGN KEY (`product_id`) REFERENCES `products` (`id`);

ALTER TABLE `variants` ADD FOREIGN KEY (`product_id`) REFERENCES `products` (`id`);

ALTER TABLE `inventory` ADD FOREIGN KEY (`product_id`) REFERENCES `products` (`id`);

ALTER TABLE `inventory` ADD FOREIGN KEY (`variant_id`) REFERENCES `variants` (`id`);

ALTER TABLE `pricing_rules` ADD FOREIGN KEY (`product_id`) REFERENCES `products` (`id`);

ALTER TABLE `voucher_usage` ADD FOREIGN KEY (`voucher_id`) REFERENCES `vouchers` (`id`);

ALTER TABLE `voucher_usage` ADD FOREIGN KEY (`user_id`) REFERENCES `users` (`id`);

ALTER TABLE `voucher_usage` ADD FOREIGN KEY (`order_id`) REFERENCES `orders` (`id`);

ALTER TABLE `shopping_carts` ADD FOREIGN KEY (`user_id`) REFERENCES `users` (`id`);

ALTER TABLE `cart_items` ADD FOREIGN KEY (`cart_id`) REFERENCES `shopping_carts` (`id`);

ALTER TABLE `cart_items` ADD FOREIGN KEY (`product_id`) REFERENCES `products` (`id`);

ALTER TABLE `cart_items` ADD FOREIGN KEY (`variant_id`) REFERENCES `variants` (`id`);

ALTER TABLE `wishlists` ADD FOREIGN KEY (`user_id`) REFERENCES `users` (`id`);

ALTER TABLE `wishlist_items` ADD FOREIGN KEY (`wishlist_id`) REFERENCES `wishlists` (`id`);

ALTER TABLE `wishlist_items` ADD FOREIGN KEY (`product_id`) REFERENCES `products` (`id`);

ALTER TABLE `orders` ADD FOREIGN KEY (`user_id`) REFERENCES `users` (`id`);

ALTER TABLE `orders` ADD FOREIGN KEY (`store_id`) REFERENCES `stores` (`id`);

ALTER TABLE `orders` ADD FOREIGN KEY (`address_id`) REFERENCES `user_addresses` (`id`);

ALTER TABLE `order_items` ADD FOREIGN KEY (`order_id`) REFERENCES `orders` (`id`);

ALTER TABLE `order_items` ADD FOREIGN KEY (`product_id`) REFERENCES `products` (`id`);

ALTER TABLE `order_items` ADD FOREIGN KEY (`variant_id`) REFERENCES `variants` (`id`);

ALTER TABLE `order_status_history` ADD FOREIGN KEY (`order_id`) REFERENCES `orders` (`id`);

ALTER TABLE `order_status_history` ADD FOREIGN KEY (`changed_by`) REFERENCES `users` (`id`);

ALTER TABLE `order_invoices` ADD FOREIGN KEY (`order_id`) REFERENCES `orders` (`id`);

ALTER TABLE `payments` ADD FOREIGN KEY (`order_id`) REFERENCES `orders` (`id`);

ALTER TABLE `payment_transactions` ADD FOREIGN KEY (`payment_id`) REFERENCES `payments` (`id`);

ALTER TABLE `refunds` ADD FOREIGN KEY (`order_id`) REFERENCES `orders` (`id`);

ALTER TABLE `refunds` ADD FOREIGN KEY (`payment_id`) REFERENCES `payments` (`id`);

ALTER TABLE `returns` ADD FOREIGN KEY (`order_id`) REFERENCES `orders` (`id`);

ALTER TABLE `returns` ADD FOREIGN KEY (`order_item_id`) REFERENCES `order_items` (`id`);

ALTER TABLE `cancellations` ADD FOREIGN KEY (`order_id`) REFERENCES `orders` (`id`);

ALTER TABLE `cancellations` ADD FOREIGN KEY (`requested_by`) REFERENCES `users` (`id`);

ALTER TABLE `order_shipments` ADD FOREIGN KEY (`order_id`) REFERENCES `orders` (`id`);

ALTER TABLE `shipping_rates` ADD FOREIGN KEY (`provider_id`) REFERENCES `shipping_providers` (`id`);

ALTER TABLE `shipping_rates` ADD FOREIGN KEY (`zone_id`) REFERENCES `shipping_zones` (`id`);

ALTER TABLE `shipping_labels` ADD FOREIGN KEY (`order_id`) REFERENCES `orders` (`id`);

ALTER TABLE `shipping_labels` ADD FOREIGN KEY (`provider_id`) REFERENCES `shipping_providers` (`id`);

ALTER TABLE `shipments` ADD FOREIGN KEY (`order_id`) REFERENCES `orders` (`id`);

ALTER TABLE `shipments` ADD FOREIGN KEY (`provider_id`) REFERENCES `shipping_providers` (`id`);

ALTER TABLE `shipment_events` ADD FOREIGN KEY (`shipment_id`) REFERENCES `shipments` (`id`);

ALTER TABLE `campaign_products` ADD FOREIGN KEY (`campaign_id`) REFERENCES `campaigns` (`id`);

ALTER TABLE `campaign_products` ADD FOREIGN KEY (`product_id`) REFERENCES `products` (`id`);

ALTER TABLE `flash_sale_items` ADD FOREIGN KEY (`flash_id`) REFERENCES `flash_sales` (`id`);

ALTER TABLE `flash_sale_items` ADD FOREIGN KEY (`product_id`) REFERENCES `products` (`id`);

ALTER TABLE `affiliate_links` ADD FOREIGN KEY (`program_id`) REFERENCES `affiliate_programs` (`id`);

ALTER TABLE `affiliate_links` ADD FOREIGN KEY (`user_id`) REFERENCES `users` (`id`);

ALTER TABLE `affiliate_commissions` ADD FOREIGN KEY (`link_id`) REFERENCES `affiliate_links` (`id`);

ALTER TABLE `affiliate_commissions` ADD FOREIGN KEY (`order_id`) REFERENCES `orders` (`id`);

ALTER TABLE `referrals` ADD FOREIGN KEY (`referrer_id`) REFERENCES `users` (`id`);

ALTER TABLE `referrals` ADD FOREIGN KEY (`referee_id`) REFERENCES `users` (`id`);

ALTER TABLE `wallets` ADD FOREIGN KEY (`user_id`) REFERENCES `users` (`id`);

ALTER TABLE `wallet_transactions` ADD FOREIGN KEY (`wallet_id`) REFERENCES `wallets` (`id`);

ALTER TABLE `chat_sessions` ADD FOREIGN KEY (`user_id`) REFERENCES `users` (`id`);

ALTER TABLE `chat_sessions` ADD FOREIGN KEY (`store_id`) REFERENCES `stores` (`id`);

ALTER TABLE `chat_messages` ADD FOREIGN KEY (`chat_session_id`) REFERENCES `chat_sessions` (`id`);

ALTER TABLE `chat_messages` ADD FOREIGN KEY (`sender_user_id`) REFERENCES `users` (`id`);

ALTER TABLE `notifications` ADD FOREIGN KEY (`user_id`) REFERENCES `users` (`id`);

ALTER TABLE `audit_logs` ADD FOREIGN KEY (`actor_user_id`) REFERENCES `users` (`id`);

ALTER TABLE `activity_logs` ADD FOREIGN KEY (`user_id`) REFERENCES `users` (`id`);

ALTER TABLE `security_events` ADD FOREIGN KEY (`user_id`) REFERENCES `users` (`id`);

ALTER TABLE `search_history` ADD FOREIGN KEY (`user_id`) REFERENCES `users` (`id`);

ALTER TABLE `recommendations` ADD FOREIGN KEY (`user_id`) REFERENCES `users` (`id`);

ALTER TABLE `recommendations` ADD FOREIGN KEY (`product_id`) REFERENCES `products` (`id`);

ALTER TABLE `files` ADD FOREIGN KEY (`owner_user_id`) REFERENCES `users` (`id`);

ALTER TABLE `product_tag` ADD FOREIGN KEY (`product_id`) REFERENCES `products` (`id`);

ALTER TABLE `product_tag` ADD FOREIGN KEY (`tag_id`) REFERENCES `tags` (`id`);

ALTER TABLE `payments` ADD COLUMN `payment_method_id` INT NULL;

ALTER TABLE `payments` 
ADD FOREIGN KEY (`payment_method_id`) 
REFERENCES `payment_methods` (`id`);

INSERT INTO permissions (uuid, code, description) VALUES
(UUID(), 'view_role', 'Xem danh sách vai trò'),
(UUID(), 'add_role', 'Thêm vai trò'),
(UUID(), 'update_role', 'Cập nhật vai trò'),
(UUID(), 'delete_role', 'Xóa vai trò'),
(UUID(), 'view_permission', 'Xem danh sách quyền'),
(UUID(), 'add_permission', 'Thêm quyền'),
(UUID(), 'update_permission', 'Cập nhật quyền'),
(UUID(), 'delete_permission', 'Xóa quyền'),
(UUID(), 'count_permission_by_role', 'Đếm quyền theo vai trò'),
(UUID(), 'add_permission_to_role', 'Gán quyền cho vai trò'),
(UUID(), 'delete_permission_from_role', 'Xóa quyền khỏi vai trò'),
(UUID(), 'view_user_role', 'Xem vai trò của người dùng'),
(UUID(), 'assign_role_to_user', 'Gán vai trò cho người dùng'),
(UUID(), 'delete_role_from_user', 'Xóa vai trò khỏi người dùng'),
(UUID(), 'view_product', 'Xem danh sach sản phẩm'),
(UUID(), 'cart_create', 'Quyền tạo giỏ hàng và thêm item'),
(UUID(), 'cart_read', 'Quyền xem giỏ hàng'),
(UUID(), 'cart_update', 'Quyền cập nhật giỏ hàng (số lượng, giá)'),
(UUID(), 'cart_delete', 'Quyền xóa item hoặc giỏ hàng'),
(UUID(), 'add_product', 'Thêm sản phẩm mới'),
(UUID(), 'update_product', 'Cập nhật sản phẩm'),
(UUID(), 'delete_product', 'Xóa sản phẩm'),
(UUID(), 'publish_product', 'Đăng sản phẩm lên store'),
(UUID(), 'view_own_products', 'Xem sản phẩm của cửa hàng mình');


INSERT INTO roles (uuid, name, description, created_at)
VALUES 
(UUID(), 'Admin', 'Quản trị viên', NOW()),
(UUID(), 'Customer', 'Khách Hàng', NOW()),
(UUID(), 'Store_Owner', 'Chủ cửa hàng', NOW());


INSERT INTO role_permissions (uuid, role_id, permission_id)
SELECT UUID(),
       (SELECT id FROM roles WHERE name = 'Admin'),
       p.id
FROM permissions p
WHERE p.code IN (
  'view_role',
  'add_role',
  'update_role',
  'delete_role',
  'view_permission',
  'add_permission',
  'update_permission',
  'delete_permission',
  'count_permission_by_role',
  'add_permission_to_role',
  'delete_permission_from_role',
  'view_user_role',
  'assign_role_to_user',
  'delete_role_from_user',
  'view_product'
);

INSERT INTO role_permissions (uuid, role_id, permission_id)
SELECT UUID(),
       (SELECT id FROM roles WHERE name = 'Store_Owner'),
       p.id
FROM permissions p
WHERE p.code IN (
  'view_own_products',
  'add_product',
  'update_product',
  'delete_product',
  'publish_product'	
);

INSERT INTO `collections` (`uuid`, `name`, `description`, `banner_url`, `status`, `created_at`)
VALUES 
    (UUID(), 'Supper sale', 'Sản phẩm siêu giảm giá', 'https://tinyurl.com/2s479rv7', 'active', CURRENT_TIMESTAMP);
    


INSERT INTO `brands` (`uuid`, `name`, `description`, `created_at`)
VALUES 
    (UUID(), 'Apple', 'Thương hiệu công nghệ Apple', CURRENT_TIMESTAMP),
    (UUID(), 'Samsung', 'Thương hiệu công nghệ Samsung', CURRENT_TIMESTAMP);

INSERT INTO `categories` (`uuid`, `parent_id`, `name`, `slug`, `description`, `created_at`, `image`, `is_deleted`)
VALUES
 (UUID(), NULL, 'test', 'test', 'Danh mục sản phẩm test ', CURRENT_TIMESTAMP, 'https://shorturl.at/YC897' , 0),
 (UUID(), NULL, 'Electronic', 'electronics', 'Danh mục sản phẩm điện tử', CURRENT_TIMESTAMP, 'https://shorturl.at/YC897', 0);



INSERT INTO `tags` (`uuid`, `name`)
VALUES 
    (UUID(), 'smartphone'),
    (UUID(), 'laptop'),
    (UUID(), 'tablet'),
    (UUID(), 'smartwatch');

INSERT INTO `stores` (`uuid`, `user_id`, `name`, `slug`, `description`, `logo_url`, `status`, `created_at`, `updated_at`,`is_draft`,`email`, `phone`)
VALUES (UUID(), 3, 'Tech Store', 'tech-store', 'Cửa hàng công nghệ hàng đầu', 'https://shorturl.at/NahZ2', 'active', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP,'khong draft','superMariO@gmail.com', '69969696969');

INSERT INTO `products` (`uuid`, `store_id`, `brand_id`, `name`, `slug`, `short_description`, `description`, `base_price`, `status`, `created_at`, `updated_at`)
VALUES 
    (UUID(), (SELECT `id` FROM `stores` WHERE `slug` = 'tech-store' LIMIT 1), (SELECT `id` FROM `brands` WHERE `name` = 'Apple' LIMIT 1),  'iPhone 13', 'iphone-13', 'Điện thoại thông minh cao cấp', 'iPhone 13 với chip A15 Bionic', 799.99, 'active', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
    (UUID(), (SELECT `id` FROM `stores` WHERE `slug` = 'tech-store' LIMIT 1), (SELECT `id` FROM `brands` WHERE `name` = 'Apple' LIMIT 1),  'MacBook Air', 'macbook-air', 'Laptop mỏng nhẹ', 'MacBook Air M1 2020', 999.99, 'active', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
    (UUID(), (SELECT `id` FROM `stores` WHERE `slug` = 'tech-store' LIMIT 1), (SELECT `id` FROM `brands` WHERE `name` = 'Samsung' LIMIT 1),  'Galaxy S21', 'galaxy-s21', 'Điện thoại flagship', 'Samsung Galaxy S21 với camera 64MP', 699.99, 'active', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
    (UUID(), (SELECT `id` FROM `stores` WHERE `slug` = 'tech-store' LIMIT 1), (SELECT `id` FROM `brands` WHERE `name` = 'Apple' LIMIT 1), 'iPad Pro', 'ipad-pro', 'Máy tính bảng cao cấp', 'iPad Pro với chip M1', 1099.99, 'active', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
    (UUID(), (SELECT `id` FROM `stores` WHERE `slug` = 'tech-store' LIMIT 1), (SELECT `id` FROM `brands` WHERE `name` = 'Samsung' LIMIT 1),  'Galaxy Tab S7', 'galaxy-tab-s7', 'Máy tính bảng mạnh mẽ', 'Samsung Galaxy Tab S7 với S Pen', 649.99, 'active', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
    (UUID(), (SELECT `id` FROM `stores` WHERE `slug` = 'tech-store' LIMIT 1), (SELECT `id` FROM `brands` WHERE `name` = 'Apple' LIMIT 1),  'Apple Watch Series 7', 'apple-watch-s7', 'Đồng hồ thông minh', 'Apple Watch Series 7 với màn hình lớn', 399.99, 'active', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
    (UUID(), (SELECT `id` FROM `stores` WHERE `slug` = 'tech-store' LIMIT 1), (SELECT `id` FROM `brands` WHERE `name` = 'Samsung' LIMIT 1),  'Galaxy Watch 4', 'galaxy-watch-4', 'Đồng hồ thông minh', 'Samsung Galaxy Watch 4 với Wear OS', 249.99, 'active', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
    (UUID(), (SELECT `id` FROM `stores` WHERE `slug` = 'tech-store' LIMIT 1), (SELECT `id` FROM `brands` WHERE `name` = 'Apple' LIMIT 1),  'MacBook Pro', 'macbook-pro', 'Laptop hiệu năng cao', 'MacBook Pro M1 Pro 2021', 1999.99, 'active', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
    (UUID(), (SELECT `id` FROM `stores` WHERE `slug` = 'tech-store' LIMIT 1), (SELECT `id` FROM `brands` WHERE `name` = 'Samsung' LIMIT 1), 'Galaxy Z Fold 3', 'galaxy-z-fold-3', 'Điện thoại gập cao cấp', 'Samsung Galaxy Z Fold 3 với màn hình AMOLED', 1799.99, 'active', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP),
    (UUID(), (SELECT `id` FROM `stores` WHERE `slug` = 'tech-store' LIMIT 1), (SELECT `id` FROM `brands` WHERE `name` = 'Apple' LIMIT 1),  'iPhone 14', 'iphone-14', 'Điện thoại thế hệ mới', 'iPhone 14 với chip A16 Bionic', 999.99, 'active', CURRENT_TIMESTAMP, CURRENT_TIMESTAMP);

select * from products


-- 6. Bảng `product_tag`: Gắn thẻ cho sản phẩm
INSERT INTO `product_tag` (`uuid`, `product_id`, `tag_id`)
VALUES 
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'iphone-13' LIMIT 1), (SELECT `id` FROM `tags` WHERE `name` = 'smartphone' LIMIT 1)),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'macbook-air' LIMIT 1), (SELECT `id` FROM `tags` WHERE `name` = 'laptop' LIMIT 1)),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'galaxy-s21' LIMIT 1), (SELECT `id` FROM `tags` WHERE `name` = 'smartphone' LIMIT 1)),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'ipad-pro' LIMIT 1), (SELECT `id` FROM `tags` WHERE `name` = 'tablet' LIMIT 1)),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'galaxy-tab-s7' LIMIT 1), (SELECT `id` FROM `tags` WHERE `name` = 'tablet' LIMIT 1)),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'apple-watch-s7' LIMIT 1), (SELECT `id` FROM `tags` WHERE `name` = 'smartwatch' LIMIT 1)),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'galaxy-watch-4' LIMIT 1), (SELECT `id` FROM `tags` WHERE `name` = 'smartwatch' LIMIT 1)),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'macbook-pro' LIMIT 1), (SELECT `id` FROM `tags` WHERE `name` = 'laptop' LIMIT 1)),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'galaxy-z-fold-3' LIMIT 1), (SELECT `id` FROM `tags` WHERE `name` = 'smartphone' LIMIT 1)),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'iphone-14' LIMIT 1), (SELECT `id` FROM `tags` WHERE `name` = 'smartphone' LIMIT 1));


INSERT INTO variants (uuid, product_id, sku, variant_name, price, stock, barcode, created_at, updated_at)
VALUES 
    -- Variants for iPhone 13
    (UUID(), (SELECT id FROM products WHERE slug = 'iphone-13' LIMIT 1), 'IPH13-512-GR9', '512GB - Green', 2999, 30, '123456789014355', NOW(), NOW()),
    (UUID(), (SELECT id FROM products WHERE slug = 'iphone-13' LIMIT 1), 'IPH13-512-GRY', '512GB - Grey', 2999, 30, '123456789014350', NOW(), NOW()),
    (UUID(), (SELECT id FROM products WHERE slug = 'iphone-13' LIMIT 1), 'IPH13-512-GLD', '512GB - Gold', 2999.99, 30, '1234567890143', NOW(), NOW()),
	(UUID(), (SELECT id FROM products WHERE slug = 'iphone-13' LIMIT 1), 'IPH13-512-RED', '512GB - RED', 1999, 30, '123456789014355', NOW(), NOW()),
    (UUID(), (SELECT id FROM products WHERE slug = 'iphone-13' LIMIT 1), 'IPH13-512-PUR', '512GB - Purple', 5999, 30, '123456789014350', NOW(), NOW()),
    (UUID(), (SELECT id FROM products WHERE slug = 'iphone-13' LIMIT 1), 'IPH13-512-ORG', '512GB - Orange', 8999.99, 30, '1234567890143', NOW(), NOW()),
    
    
    
    -- Variants for MacBook Air
    (UUID(), (SELECT id FROM products WHERE slug = 'macbook-air' LIMIT 1), 'MBAIR-M1-512', 'M1 Chip - 512GB SSD', 1199.99, 25, '1234567890144', NOW(), NOW()),
    
    (UUID(), (SELECT id FROM products WHERE slug = 'macbook-air' LIMIT 1), 'MBAIR-PRO', 'M1 Chip - 1TB SSD', 4199.99, 25, '1234567890144', NOW(), NOW()),
    
    -- Variants for Galaxy S21
    (UUID(), (SELECT id FROM products WHERE slug = 'galaxy-s21' LIMIT 1), 'GS21-256-WHT', '256GB - White', 799.99, 60, '1234567890145', NOW(), NOW()),
    -- Variants for iPad Pro
    (UUID(), (SELECT id FROM products WHERE slug = 'ipad-pro' LIMIT 1), 'IPADPRO-256', '256GB', 1199.99, 35, '1234567890146', NOW(), NOW()),
    -- Variants for Galaxy Tab S7
    (UUID(), (SELECT id FROM products WHERE slug = 'galaxy-tab-s7' LIMIT 1), 'GTABS7-256', '256GB', 749.99, 50, '1234567890147', NOW(), NOW()),
    -- Variants for Apple Watch Series 7
    (UUID(), (SELECT id FROM products WHERE slug = 'apple-watch-s7' LIMIT 1), 'AW7-45MM', '45mm', 429.99, 60, '1234567890148', NOW(), NOW()),
    -- Variants for Galaxy Watch 4
    (UUID(), (SELECT id FROM products WHERE slug = 'galaxy-watch-4' LIMIT 1), 'GW4-44MM', '44mm', 279.99, 80, '1234567890149', NOW(), NOW()),
    -- Variants for MacBook Pro
    (UUID(), (SELECT id FROM products WHERE slug = 'macbook-pro' LIMIT 1), 'MBPRO-M1P-1TB', 'M1 Pro - 1TB SSD', 2399.99, 15, '1234567890150', NOW(), NOW()),
    -- Variants for Galaxy Z Fold 3
    (UUID(), (SELECT id FROM products WHERE slug = 'galaxy-z-fold-3' LIMIT 1), 'GZFold3-512', '512GB', 1899.99, 20, '1234567890151', NOW(), NOW()),
    -- Variants for iPhone 14
    (UUID(), (SELECT id FROM products WHERE slug = 'iphone-14' LIMIT 1), 'IPH14-256-BLK', '256GB - Black', 1099.99, 40, '1234567890152', NOW(), NOW());
    

INSERT INTO `product_media` (uuid, product_id, variant_id, media_type, url, is_primary, sort_order)
VALUES 

(UUID(), (SELECT id FROM products WHERE slug = 'iphone-13' LIMIT 1), 
     (SELECT id FROM variants WHERE sku = 'IPH13-512-GR9' LIMIT 1), 'image', 'https://shorturl.at/hTIQR', true, 1),
     
(UUID(), (SELECT id FROM products WHERE slug = 'iphone-13' LIMIT 1), 
     (SELECT id FROM variants WHERE sku = 'IPH13-512-GRY' LIMIT 1), 'image', 'https://shorturl.at/LFkD7', true, 1),
     
(UUID(), (SELECT id FROM products WHERE slug = 'iphone-13' LIMIT 1), 
     (SELECT id FROM variants WHERE sku = 'IPH13-512-GLD' LIMIT 1), 'image', 'https://shorturl.at/9zSZO', true, 1),
     
(UUID(), (SELECT id FROM products WHERE slug = 'iphone-13' LIMIT 1), 
     (SELECT id FROM variants WHERE sku = 'IPH13-512-RED' LIMIT 1), 'image', 'https://shorturl.at/2uItj', true, 1),

(UUID(), (SELECT id FROM products WHERE slug = 'iphone-13' LIMIT 1), 
     (SELECT id FROM variants WHERE sku = 'IPH13-512-PUR' LIMIT 1), 'image', 'https://shorturl.at/1CDCG', true, 1),
     
(UUID(), (SELECT id FROM products WHERE slug = 'iphone-13' LIMIT 1), 
     (SELECT id FROM variants WHERE sku = 'IPH13-512-ORG' LIMIT 1), 'image', 'https://shorturl.at/6dX46', true, 1),         
     

(UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'macbook-air' LIMIT 1),
    (SELECT id FROM variants WHERE sku = 'MBAIR-M1-512' LIMIT 1), 'image', 'https://shorturl.at/htBjF', true, 1),
    
	(UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'macbook-air' LIMIT 1),
(SELECT id FROM variants WHERE sku = 'MBAIR-PRO' LIMIT 1), 'image', 'https://shorturl.at/kEKng', true, 1),
    

    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'galaxy-s21' LIMIT 1), 5, 'image', 'https://shorturl.at/DNdL1', true, 1),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'ipad-pro' LIMIT 1), 6,'image', 'https://shorturl.at/AtcVt', true, 1),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'galaxy-tab-s7' LIMIT 1), 7, 'image', 'https://shorturl.at/54Na1', true, 1),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'apple-watch-s7' LIMIT 1), 8, 'image', 'https://shorturl.at/54Na1', true, 1),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'galaxy-watch-4' LIMIT 1), 9, 'image', 'https://tinyurl.com/2y8wwvkz', true, 1),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'macbook-pro' LIMIT 1), 10, 'image', 'https://tinyurl.com/2ac4w9sy', true, 1),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'galaxy-z-fold-3' LIMIT 1), 11, 'image', 'https://tinyurl.com/2fczd6yc', true, 1),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'iphone-14' LIMIT 1), 12, 'image', 'https://tinyurl.com/wxdstpdm', true, 1);


INSERT INTO `product_category` (`uuid`, `product_id`, `category_id`)
VALUES 
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'iphone-13' LIMIT 1), (SELECT `id` FROM `categories` WHERE `slug` = 'electronics' LIMIT 1)),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'macbook-air' LIMIT 1), (SELECT `id` FROM `categories` WHERE `slug` = 'electronics' LIMIT 1)),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'galaxy-s21' LIMIT 1), (SELECT `id` FROM `categories` WHERE `slug` = 'electronics' LIMIT 1)),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'ipad-pro' LIMIT 1), (SELECT `id` FROM `categories` WHERE `slug` = 'electronics' LIMIT 1)),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'galaxy-tab-s7' LIMIT 1), (SELECT `id` FROM `categories` WHERE `slug` = 'electronics' LIMIT 1)),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'apple-watch-s7' LIMIT 1), (SELECT `id` FROM `categories` WHERE `slug` = 'electronics' LIMIT 1)),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'galaxy-watch-4' LIMIT 1), (SELECT `id` FROM `categories` WHERE `slug` = 'electronics' LIMIT 1)),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'macbook-pro' LIMIT 1), (SELECT `id` FROM `categories` WHERE `slug` = 'electronics' LIMIT 1)),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'galaxy-z-fold-3' LIMIT 1), (SELECT `id` FROM `categories` WHERE `slug` = 'electronics' LIMIT 1)),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'iphone-14' LIMIT 1), (SELECT `id` FROM `categories` WHERE `slug` = 'electronics' LIMIT 1));

INSERT INTO `product_collection` (`uuid`, `product_id`, `collection_id`)
VALUES 
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'iphone-13' LIMIT 1), (SELECT `id` FROM `collections` WHERE `name` = 'Best Sellers' LIMIT 1)),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'macbook-air' LIMIT 1), (SELECT `id` FROM `collections` WHERE `name` = 'Best Sellers' LIMIT 1)),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'galaxy-s21' LIMIT 1), (SELECT `id` FROM `collections` WHERE `name` = 'Best Sellers' LIMIT 1)),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'ipad-pro' LIMIT 1), (SELECT `id` FROM `collections` WHERE `name` = 'Best Sellers' LIMIT 1)),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'galaxy-tab-s7' LIMIT 1), (SELECT `id` FROM `collections` WHERE `name` = 'Best Sellers' LIMIT 1)),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'apple-watch-s7' LIMIT 1), (SELECT `id` FROM `collections` WHERE `name` = 'Best Sellers' LIMIT 1)),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'galaxy-watch-4' LIMIT 1), (SELECT `id` FROM `collections` WHERE `name` = 'New Arrivals' LIMIT 1)),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'macbook-pro' LIMIT 1), (SELECT `id` FROM `collections` WHERE `name` = 'New Arrivals' LIMIT 1)),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'galaxy-z-fold-3' LIMIT 1), (SELECT `id` FROM `collections` WHERE `name` = 'New Arrivals' LIMIT 1)),
    (UUID(), (SELECT `id` FROM `products` WHERE `slug` = 'iphone-14' LIMIT 1), (SELECT `id` FROM `collections` WHERE `name` = 'New Arrivals' LIMIT 1));

-- Insert additional inventory for new variants
INSERT INTO inventory (uuid, product_id, variant_id, location, quantity, used_quantity, updated_at)
VALUES 
    -- Inventory for iPhone 13
    (UUID(), 1, 1, 'Warehouse A', 30, 0, NOW()),
    (UUID(), 1, 2, 'Warehouse A', 66, 0, NOW()),
    (UUID(), 1, 3, 'Warehouse A', 88, 0, NOW()),
    (UUID(), 1, 4, 'Warehouse A', 77, 0, NOW()),
    (UUID(), 1, 5, 'Warehouse A', 88, 0, NOW()),
    (UUID(), 1, 6, 'Warehouse A', 99, 0, NOW()),
    -- Inventory for MacBook Air
    (UUID(), 2, 7, 'Warehouse B', 25, 0, NOW()),
    (UUID(), 2, 8, 'Warehouse B', 25, 0, NOW()),
    -- Inventory for Galaxy S21
    (UUID(), 3, 9, 'Warehouse A', 60, 0, NOW()),
    -- Inventory for iPad Pro
    (UUID(), 4,  10, 'Warehouse B', 35, 0, NOW()),
    -- Inventory for Galaxy Tab S7
    (UUID(), 5,11,  'Warehouse A', 50, 0, NOW()),
    -- Inventory for Apple Watch Series 7
    (UUID(), 6,12,  'Warehouse C', 60, 0, NOW()),
    -- Inventory for Galaxy Watch 4
    (UUID(), 7, 13, 'Warehouse C', 80, 0, NOW()),
    -- Inventory for MacBook Pro
    (UUID(), 8, 14, 'Warehouse B', 15, 0, NOW()),
    -- Inventory for Galaxy Z Fold 3
    (UUID(), 9, 15, 'Warehouse A', 20, 0, NOW()),
    -- Inventory for iPhone 14
    (UUID(), 10, 16, 'Warehouse A', 40, 0, NOW());

INSERT INTO pricing_rules (uuid, product_id, type, min_quantity, price, cycle, starts_at, ends_at)
VALUES 
    (UUID(), (SELECT id FROM products WHERE slug = 'iphone-13' LIMIT 1), 'bulk', 4, 750.00, 'once', NOW(), DATE_ADD(NOW(), INTERVAL 30 DAY)),
    (UUID(), (SELECT id FROM products WHERE slug = 'macbook-air' LIMIT 1), 'bulk', 3, 950.00, 'monthly', NOW(), DATE_ADD(NOW(), INTERVAL 45 DAY)),
    (UUID(), (SELECT id FROM products WHERE slug = 'galaxy-s21' LIMIT 1), 'bulk', 3, 650.00, 'once', NOW(), DATE_ADD(NOW(), INTERVAL 30 DAY)),
    (UUID(), (SELECT id FROM products WHERE slug = 'ipad-pro' LIMIT 1), 'bulk', 2, 1050.00, 'monthly', NOW(), DATE_ADD(NOW(), INTERVAL 45 DAY)),
    (UUID(), (SELECT id FROM products WHERE slug = 'galaxy-tab-s7' LIMIT 1), 'bulk', 3, 600.00, 'once', NOW(), DATE_ADD(NOW(), INTERVAL 30 DAY)),
    (UUID(), (SELECT id FROM products WHERE slug = 'apple-watch-s7' LIMIT 1), 'bulk', 5, 380.00, 'once', NOW(), DATE_ADD(NOW(), INTERVAL 30 DAY)),
    (UUID(), (SELECT id FROM products WHERE slug = 'galaxy-watch-4' LIMIT 1), 'bulk', 5, 230.00, 'once', NOW(), DATE_ADD(NOW(), INTERVAL 30 DAY)),
    (UUID(), (SELECT id FROM products WHERE slug = 'macbook-pro' LIMIT 1), 'bulk', 2, 1900.00, 'monthly', NOW(), DATE_ADD(NOW(), INTERVAL 45 DAY)),
    (UUID(), (SELECT id FROM products WHERE slug = 'galaxy-z-fold-3' LIMIT 1), 'bulk', 2, 1700.00, 'once', NOW(), DATE_ADD(NOW(), INTERVAL 30 DAY)),
    (UUID(), (SELECT id FROM products WHERE slug = 'iphone-14' LIMIT 1), 'bulk', 3, 950.00, 'monthly', NOW(), DATE_ADD(NOW(), INTERVAL 45 DAY));



-- Insert additional vouchers for testing
INSERT INTO vouchers (uuid, code, description, discount_type, discount_value, min_order_amount, start_date, end_date, usage_limit, used_count, created_at)
VALUES 
    (UUID(), 'SAVE15', 'Giảm 15% cho đơn hàng từ 800$', 'percentage', 	15.00, 800.00, NOW(), DATE_ADD(NOW(), INTERVAL 15 DAY), 150, 0, NOW()),
    (UUID(), 'FIXED75', 'Giảm cố định 75$ cho đơn hàng từ 300$', 'fixed', 75.00, 300.00, NOW(), DATE_ADD(NOW(), INTERVAL 10 DAY), 100, 0, NOW());


INSERT INTO `payment_methods` (`uuid`, `name`, `type`, `config`, `enabled`, `created_at`) VALUES
(UUID(), 'Thanh toán khi nhận hàng', 'cod', NULL, TRUE, NOW()),
(UUID(), 'Ví MoMo', 'momo', NULL, TRUE, NOW()),
(UUID(), 'ZaloPay', 'zalopay', NULL, TRUE, NOW()),
(UUID(), 'VNPay', 'vnpay', NULL, TRUE, NOW()),
(UUID(), 'Viettel Money', 'viettel_money', NULL, TRUE, NOW()),
(UUID(), 'Thẻ tín dụng/Ghi nợ', 'card', NULL, TRUE, NOW());

INSERT INTO user_roles (uuid, user_id, role_id, assigned_at)
VALUES (
    UUID(),
    1,
    (SELECT id FROM roles WHERE name = 'Admin'),
    NOW()
);

